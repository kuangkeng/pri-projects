<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  <title>Toll Expenses Calculator</title>

  <!-- Bootstrap -->
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.inputmask/3.2.5/jquery.inputmask.bundle.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.4.2/tabletop.min.js"></script> 

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<style>
  body {
      font-family: "Source Sans Pro","Helvetica Neue",Helvetica,Arial,"Nimbus Sans L",sans-serif;
    }
    #phonewiz { margin-top: 20px; padding-bottom: 60px; max-width: 700px;}
    #intro {
      background: //url("http://38.media.tumblr.com/b8ca5764ca406bdd13f1fd9a80f3d4ea/tumblr_mv2hylnf8l1se5kcvo1_500.gif") no-repeat center;

    }

    .title {
      font-size: 30px;
      font-weight: 600;
      color: #333;
      margin-bottom: 20px;
      line-height: 1.2em;
      text-align: center;
    }

    .question {
      font-size: 25px;
      font-weight: 400;
      color: #333;
      margin-bottom: 20px;
      line-height: 1.2em;
      text-align: center;
    }

    .blurb {
      font-size: 20px;
      color: #333;
      margin: 20px 0 40px 0;
      text-align: center;
    }

    #lead-img{
      font-size: 18px;
      text-align: center;
      height: 300px;
    }

   .mybtn {
      background-color: #18216d;
      padding: 10px 40px;
      font-size: 22px;
      font-weight: 400;
      color: #FFF;
      border-radius: 10px;
      display: block;
      margin: 0 auto;
      width: 140px;
      text-align: center;
    }
    .mybtn:hover {
      color: #FFF;
      background-color: #f16524;
      cursor: pointer;
    }

    .startbtn{
      background-color: #18216d;
      padding: 10px 40px;
      font-size: 17px;
      font-weight: 400;
      border-radius: 10px;
      color: #fff;
      display: right;
      margin: 0 auto;
      width: 140px;
      text-align: center;
    }

    .startbtn:hover {
      color: #FFF;
      background-color: #f16524;
      cursor: pointer;
    }

    .submit {
    background-color: #f16524;
    padding: 10px 40px;
    font-size: 22px;
    font-weight: 400;
    color: #FFFFFF;
    border-radius:10px;
    display:block;
    margin: 0 auto;
    width: 200px;
    text-align: center;
    }

    .submit:hover {
    color: #FFF;
    background-color: #18216d;
    cursor: pointer;
    }

    #question {
      font-size: 14px;
      color: #999;
      margin: 10px 0 10px 0;
    }

    input[type=radio], input[type=checkbox] {
      margin: 3px 0 0;
    }

    label {
      font-size: 18px;
      font-weight: 300 !important;
      color: #23538e;
      margin-bottom: 10px !important;
      line-height: 1.2em;
    }

    #resBtn { margin-top: 20px; margin-bottom: 10px; }

table {
        border-collapse: collapse;
        border: none;
        padding: 10px;
    } 
        
    td {
        font-size:14px;
        line-height: 1.2em;
        padding: 5px;
        text-align: center;
        border: none;
    }
    
    #firstrow {
      background-color: #f16524;
      color: #fff;
    }
    
    #secondrow {
      background-color: #f8b291;
    }
  
    #thirdrow {
      background-color: #f2f2f2;
    }
  
    #totalrow {
      background-color: #18216d;
      color: #fff;
    }
  
    #colyearly {
      width: 25%;
    }
  
    #coldaily {
      width: 15%;
    }
  
    #colend {
      width: 25%;
    }
  
    #result {
      padding: 15px;
    }
  
    .hide {display: none;}

    @media (max-width: 500px ) {
      #counter, #q1counter { margin: 0px; }

    
    #hiderow, #coldaily {
      display: none;
    }
  
      .blurb {
        font-size: 17px;
        line-height: 1.3em;
      }
      .question {
        font-size: 25px;
        line-height: 1.2em;
      }

    }
</style>

<body>
  <div id="tollcal" class="parent" style="width:100%; padding-bottom:5px;">
    <div id="phonewiz" class="container">

      <div class="row">
        <div id="intro" class="col-sm-12 col-xs-12">
          <div class="title">How much toll you would need to pay for your entire life?</div>
          <div class="blurb">By the new toll rate, how much that you need to pay in the future? We can help you to calculate the amount and how long you need to pay when the concession of the highway(s) end(s).</div>
          <div id="begin" class="startbtn">Start</div>
        </div>

        <div id="q1" class="hide col-sm-12 col-xs-12">
          <div class="question">Tell us about you:</div>
          <br>


          <form role="form" name="calculator" class="form-horizontal" method="get" action="#">
            <label>How old are you?</label>
            <select class="form-control" id="InputAge" placeholder="Select your age" required>
              <option disabled selected>Select your age</option>
              <option>13</option>
              <option>14</option>
              <option>15</option>
              <option>16</option>
              <option>17</option>
              <option>18</option>
              <option>19</option>
              <option>20</option>
              <option>21</option>
              <option>22</option>
              <option>23</option>
              <option>24</option>
              <option>25</option>
              <option>26</option>
              <option>27</option>
              <option>28</option>
              <option>29</option>
              <option>30</option>
              <option>31</option>
              <option>32</option>
              <option>33</option>
              <option>34</option>
              <option>35</option>
              <option>36</option>
              <option>37</option>
              <option>38</option>
              <option>39</option>
              <option>40</option>
              <option>41</option>
              <option>42</option>
              <option>43</option>
              <option>44</option>
              <option>45</option>
              <option>46</option>
              <option>47</option>
              <option>48</option>
              <option>49</option>
              <option>50</option>
              <option>51</option>
              <option>52</option>
              <option>53</option>
              <option>54</option>
              <option>55</option>
              <option>56</option>
              <option>57</option>
              <option>58</option>
              <option>59</option>
              <option>60</option>
              <option>61</option>
              <option>62</option>
              <option>63</option>
              <option>64</option>
              <option>65</option>
              <option>66</option>
              <option>67</option>
              <option>68</option>
              <option>69</option>
              <option>70</option>
              <option>71</option>
              <option>72</option>
              <option>73</option>
              <option>74</option>
              <option>75</option>
              <option>76</option>
              <option>77</option>
              <option>78</option>
              <option>79</option>
              <option>80</option>
              <option>81</option>
              <option>82</option>
              <option>83</option>
              <option>84</option>
              <option>85</option>
              <option>86</option>
              <option>87</option>
              <option>88</option>
              <option>89</option>
              <option>90</option>
              <option>91</option>
              <option>92</option>
              <option>93</option>
              <option>94</option>
              <option>95</option>
              <option>96</option>
              <option>97</option>
              <option>98</option>
              <option>99</option>
            </select>

            <br>

            <label>Which is the highway that you used to work daily?</label>
            <div class="input-group">
              <select id="hw" class="form-control" required>
                <option value="">Please select</option>
              </select>
            </div>
            <br>
            <label>How much you spend on the toll of that particular highway? (RM)</label>
            <div class="input-group">
              <input id="tollInput" type="input" class="form-control" data-validation="[NOTEMPTY]" placeholder="eg: 1.50" required>
            </div>
            <br>
            <label>If you use more than one highway to work daily, please click YES.</label>
            <br>
            <span class="hide error-message"></span>
            <div id="add-highway" type="button" class="startbtn">YES</div>
            <div class="input-group hide">
              <select id="hw2" class="form-control">
                <option value="">Please select another highway that you use to work daily.</option>
              </select>
              <br>
              <br>
              <label>How much you need do spend on this highway to work daily?</label>
              <div class="input-group">
                <input id="tollInput2" type="input" class="form-control" data-validation="[NOTEMPTY]" placeholder="eg: 2.00">
              </div>
            </div>
            <br>
            <label>Or elase, you can view your result by clicking the button below</label>

            <input id="submit" type="submit" class="submit" value="See my Result" />
          </form>
        </div>

        <div id="result" class="hide title">Oh no!
          <br> You need to pay
          <br> RM
          <span id="titletotal"></span>
          <br> right until you are
          <br>
          <span id="endAge"></span>!
        </div>
        <br>
        <br>
        <div id="table" class="question hide">
          <span id="title1"></span> project was started on <span id="projectStart1"></span> with the cost of RM<span id="cost1"></span>.
          <br>The concession period will end on <span id="projectEnd1"></span> when you are <span id="firstAge"></span>.
          <br>
          <br>
          <div id="seconddescription" class="hide">
            <span id="title2"></span> project was started on <span id="projectStart2"></span> with the cost of RM<span id="cost2"></span>.
            <br>The concession period will end on <span id="projectEnd2"></span> when you are <span id="secondAge"></span>.
          </div>
          <br>
          <br>
          <table border="1">
            <tr id="firstrow">
              <td colspan="4">How much you need to pay? (RM)</td>
            </tr>
            <tr id="secondrow">
              <td>Highway</td>
              <td id="coldaily">daily</td>
              <td id="colyearly">yearly</td>
              <td id="colend">when concession ends</td>
            </tr>
            <tr id="thirdrow">
              <td><span id="Atitle"></span></td>
              <td id="hiderow"><span id="oneday1"></span></td>
              <td><span id="oneyear1"></span></td>
              <td><span id="sum1"></span></td>
            </tr>
            <tr id="thirdrow" class=".secondhighway hide">
              <td><span id="Btitle"></span></td>
              <td id="hiderow"><span id="oneday2"></span></td>
              <td><span id="oneyear2"></span></td>
              <td><span id="sum2"></span></td>
            </tr>
            <tr id="totalrow">
              <td>Total</td>
              <td id="hiderow"><span id="sumday"></span></td>
              <td><span id="sumyear"></span></td>
              <td><span id="total"></span></td>
            </tr>
          </table>


        </div>
        <br>


      </div>

    </div>
  </div>
  </div>


  <!-- Include all compiled plugins (below), or include individual files as needed -->

  <script>
    $(function() {

    //$('#age').inputmask({'mask':"999", greedy: false});
      //$('#tollInput').inputmask({'mask':"9{0,3}.9{0,2}", greedy: false});
    //$('#tollInput2').inputmask({'mask':"9{0,3}.9{0,2}", greedy: false});

            var calculatorForm = $('form[name="calculator"]');
        var obj = {

        akleh: {
        title: "Ampang-Kuala Lumpur Elevated Highway (AKLEH)",
        projectStart: 2001,
        projectEnd: 2029,
        cost: "462,700,000",
        },
      besraya: {
        title: "Besraya Expressway",
        projectStart: 1999,
        projectEnd: 2040,
        cost: "278,830,000",
        },
      bke: {
        title: "Butterworth-Kulim Expressway (BKE)",
        projectStart: 1994,
        projectEnd: 2038,
        cost: "255,850,000",
        },
        llb: {
        title: "Butterworth Outer Ring Road (LLB)",
        projectStart: 1997,
        projectEnd: 2028,
        cost: "252,400,000",
        },
      grandsaga: {
        title: "Cheras Kajang Expressway",
        projectStart: 1995,
        projectEnd: 2045,
        cost: "286,490,000",
        },
      duke: {
        title: "Duta-Ulu Klang Expressway (DUKE)",
        projectStart: 2010,
        projectEnd: 2059,
        cost: "822,000,000",
        },
      ece: {
        title: "East Coast Highway",
        projectStart: 1994,
        projectEnd: 2032,
        cost: "1,300,000,000",
        },
      elite: {
        title: "Elite Expressway",
        projectStart: 1994,
        projectEnd: 2038,
        cost: "1,249,880,000",
        },
      fh2: {
        title: "Federal Highway",
        projectStart: 1998,
        projectEnd: 2038,
        cost: "357,000,000",
        },
      gce: {
        title: "Guthrie Corridor Expressway (GCE)",
        projectStart: 2005,
        projectEnd: 2036,
        cost: "660,000,000",
        },
      edl: {
        title: "Johor Bahru Eastern Dispersal Link Expressway (EDL)",
        projectStart: 2008,
        projectEnd: 2042,
        cost: "723,000,000",
        },
      klk: {
        title: "Karak Expressway (KLK)",
        projectStart: 1994,
        projectEnd: 2032,
        cost: "451,700,000",
        },
      silk: {
        title: "Kajang Dispersal Link Expressway (SILK)",
        projectStart: 2001,
        projectEnd: 2037,
        cost: "1,003,000,000",
        },
      lekas: {
        title: "Kajang-Seremban Highway (Lekas)",
        projectStart: 2008,
        projectEnd: 2039,
        cost: "766,000,000",
        },
      klsa: {
        title: "Kemuning-Shah Alam Highway (LKSA)",
        projectStart: 2010,
        projectEnd: 2047,
        cost: "406,600,000",
        },
      latar: {
        title: "Kuala Lumpur-Kuala Selangor Expressway (LATAR)",
        projectStart: 2008,
        projectEnd: 2048,
        cost: "1,027,000,000",
        },
      
      
      ldp: {
        title: "Lebuhraya Damansara Puchong (LDP)",
        projectStart: 1996,
        projectEnd: 2030,
        cost: "1,080,000,000",
        },
      secondlink: {
        title: "Malaysia–Singapore Second Link",
        projectStart: 1993,
        projectEnd: 2038,
        cost: "1,026,160,000",
        },
      mex: {
        title: "Maju Expressway (MEX)",
        projectStart: 2004,
        projectEnd: 2045,
        cost: "1,252,000,000",
        },
      nkve: {
        title: "New Klang Valley Expressway (NKVE)",
        projectStart: 1988,
        projectEnd: 2038,
        cost: "1,000,000,000",
        },
      nnksb: {
        title: "New North Klang Straits Bypass (NNKSB)",
        projectStart: 1995,
        projectEnd: 2032,
        cost: "320,000,000",
        },
      pgbridge: {
        title: "Penang Bridge",
        projectStart: 1993,
        projectEnd: 2038,
        cost: "943,540,000",
        },
      secondbridge: {
        title: "Penang Second Bridge",
        projectStart: 2008,
        projectEnd: 2053,
        cost: "4,500,000,000",
        },
      plus: {
        title: "North South Expressway (PLUS)",
        projectStart: 1988,
        projectEnd: 2038,
        cost: "5,945,770,000",
        },
      kesas: {
        title: "Shah Alam Expressway (Kesas)",
        projectStart: 1993,
        projectEnd: 2032,
        cost: "1,115,880,000",
        },
      sde: {
        title: "Senai-Desaru Expressway (SDE)",
        projectStart: 2004,
        projectEnd: 2048,
        cost: "1,371,000,000",
        },
      spdh: {
        title: "Seremban Port Dickson Highway (SPDH)",
        projectStart: 1998,
        projectEnd: 2038,
        cost: "224,610,000",
        },
      skve: {
        title: "South Klang Valley Expressway (SKVE)",
        projectStart: 2006,
        projectEnd: 2047,
        cost: "1,100,000,000",
        },
      smart: {
        title: "Stormwater Management And Road Tunnel (SMART)",
        projectStart: 2002,
        projectEnd: 2042,
        cost: "1,930,000,000",
        },
        sprint: {
        title: "Sprint Expressway",
        projectStart: 1998,
        projectEnd: 2034,
        cost: "1,246,000,000",
        }
      };

        $.each(obj, function(i, value){
          $('#hw').append('<option value="'+ i + '">' + value.title + '</option>');
        });
      
      

        $(document).ready(function(){
          $("#begin").click(function(){
            $("#intro").fadeOut("fast", function(){
              $("#q1").removeClass("hide");
            });
          });

          $('#add-highway').click(function() {
            var selectedHw = $('#hw option:selected');
            if (selectedHw.val() === '') {
              alert('Please select a highway first.');
            } else {
              var newSelect = $('select#hw2');
              newSelect.parent('div').removeClass('hide');
              //newSelect.attr('required', 'required');

              $.each(obj, function(i, value){
                if (i != selectedHw.val()) {
                  $('select#hw2').append('<option value="'+ i + '">' + value.title + '</option>');
                }
              });

              $('#add-highway').addClass('hide');
            }
          });
        });

        //Calculation and result

            calculatorForm.on('submit', function() {
        $("#result").removeClass("hide");
        $("#table").removeClass("hide");
              event.preventDefault();

          $("#q1").fadeOut("fast", function(){
          var age = calculatorForm.find('#inputAge').val(),
            tollInput = calculatorForm.find('input#tollInput').val(),
          tollInput2 = calculatorForm.find('input#tollInput2').val(),
            selectedHw = calculatorForm.find('#hw option:selected').val(),
            selectedHw2 = calculatorForm.find('#hw2 option:selected').val(),
            selectedObj1 = obj[selectedHw],
          selectedObj2 = obj[selectedHw2] || {
          projectEnd : 0};
          
          if(selectedObj2.projectEnd>0){
          $(".secondhighway").removeClass("hide");
          $("#seconddescription").removeClass("hide");
          };
          
          if(selectedObj1.projectEnd > selectedObj2.projectEnd) {
            var longestEnd = selectedObj1.projectEnd;
            } else {
              var longestEnd = selectedObj2.projectEnd;
              }

          var d = new Date(),
            thisyear = d.getFullYear(),
          firstAge = (selectedObj1.projectEnd - thisyear) + parseInt(age, 10),
          secondAge = (selectedObj2.projectEnd - thisyear) + parseInt(age, 10),
            endAge = (longestEnd - thisyear) + parseInt(age, 10),
          periodhw1= (selectedObj1.projectEnd - thisyear) + parseInt(age, 10),
          periodhw2= (selectedObj2.projectEnd - thisyear) + parseInt(age, 10),
          oneday = Number(tollInput) + Number(tollInput2),
          
          oneyearhw1 = tollInput * 5 * 52,
          oneyearhw2 = tollInput2 *5 * 52,
            oneyear = oneyearhw1 + oneyearhw2,
          sumhw1 = oneyearhw1 * periodhw1,
          sumhw2 = oneyearhw2 * periodhw2,
          sum = sumhw1 + sumhw2;
        
        $('#Atitle').html(selectedObj1.title);
        $('#Btitle').html(selectedObj2.title);
        $('#oneday1').html(tollInput);
        $('#oneday2').html(tollInput2);
        $('#sumday').html(oneday.toFixed(2));
        $('#oneyear1').html(oneyearhw1.toFixed(2));
        $('#oneyear2').html(oneyearhw2.toFixed(2));
        $('#sumyear').html(oneyear.toFixed(2));
        $('#sum1').html(sumhw1.toFixed(2));
        $('#sum2').html(sumhw2.toFixed(2));
        $('#total, #titletotal').html(sum.toFixed(2));
        $('#endAge').html(endAge);
        $('#title1').html(selectedObj1.title);
        $('#cost1').html(selectedObj1.cost);
        $('#projectStart1').html(selectedObj1.projectStart);
        $('#projectEnd1').html(selectedObj1.projectEnd);
        $('#firstAge').html(firstAge);
        $('#title2').html(selectedObj2.title);
        $('#cost2').html(selectedObj1.cost);
        $('#projectStart2').html(selectedObj2.projectStart);
        $('#projectEnd2').html(selectedObj2.projectEnd);
        $('#secondAge').html(secondAge);

          console.log('age = ', age);
              console.log('highway = ', selectedHw);
        console.log('tollInput = ', tollInput);
        console.log('periodhw1 = ', periodhw1);
          console.log('2nd Highway = ', selectedHw2);
        console.log('tollInput2 = ', tollInput2);
        console.log('periodhw2 = ', periodhw2);
        console.log('how much you need to pay for one day = ', oneday);
        console.log('oneyearhw1 = ', oneyearhw1);
        console.log('oneyearhw2 = ', oneyearhw2);
        console.log('how much you need to pay for one year = ', oneyear);
        console.log('thisyear = ', thisyear);
        console.log('firstAge = ', firstAge);
        console.log('secondAge = ', secondAge);
        console.log('Until how old you need to pay = ', endAge);
        console.log('how much needs to be pay for hw1 until contranct ends = ', sumhw1);
        console.log('how much needs to be pay for hw2 until contranct ends = ', sumhw2);
        console.log('total you need to pay = ', sum);

//run sendData function to send data to google form
        sendData();        



//tabletop function goes here to convert google spreadsheet into json
        var public_spreadsheet_url = 'https://docs.google.com/spreadsheets/d/1YXjKVRE0avt40e4QbGsqPu0vomAYhOhFJEDRHO9BJ0c/pubhtml';
        Tabletop.init( { key: public_spreadsheet_url,
                         callback: showInfo,
                         simpleSheet: true } )
        function showInfo(dataset, tabletop) {
        console.log(dataset);

        }      

        
          
            })

        });


    });

//send data to google sheets
      function sendData() {
        $.getJSON("https://api.ipify.org?format=jsonp&callback=?",
          function(json) {
            console.log("push to google sheets!");
            $.ajax({
              type: 'POST',
              url: 'https://docs.google.com/forms/d/1ZFJjA227jIgKqLsRbhvDj4ecYRhkvHtWIiDpmcc5h54/formResponse',
              data: { 
                "entry.522889191": json.ip, //ip
                "entry.1896422018": age,
                "entry.1065609951": sumhw1,
                "entry.1902035501": sumhw2,
                "entry.435354040": sum,
              }
            }); 
          }
        );   
      }



  </script>

</body>

</html>