<head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.3/ScrollMagic.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.3/plugins/animation.gsap.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.5/plugins/debug.addIndicators.min.js"></script>

<style>
html, body {
  height: 100%;
}


body {
  font-family: "Source Sans Pro","Helvetica Neue",Helvetica,Arial,"Nimbus Sans L",sans-serif;
  font-size: 112.5%;
  line-height: 1.5em;
  color: #33333c;
      }  

#container{
    height:500px;
    max-width: 850px;
}

#wrapper {
    display:inline-block;
    position: relative;
    border:1px solid #D3D3D3;
    max-width: 850px; 
    margin: 0 auto;
}

#note {
    font-size: 11px;
    color: #808080;
    line-height: 14px;
    padding:0px 10px 10px 10px;
}

#credit {
    font-size: 10px;
    padding-top: 10px;
    text-align: right;
}

#text {
    font-size: 14px;
    font-weight: bold;
    padding-bottom: 10px;
    color: #33333c;
    line-height: 18px;
}

.button01 {text-align: center;}
#button01 {
    border-radius: 5px; 
    padding:5px 10px;
    background-color:#0375B4;
    color:white;
    margin-bottom: 10px;
}
#button01:hover {background-color:#67acd2;}
#button01:focus, input[type="button"]:focus {outline: none;}


#frame {
  margin-top: 0px;
  margin-bottom: 0px;
  padding: 10px;
  outline: 1px dashed orange;
  text-align: center;
}


@media (max-width: 600px ) { 
    #container {height: 450px;}
} 

@media (max-width: 500px ) { 
    #container {height: 350px;}
} 

</style>
</head>

<body>
<div id="frame">  
<div id="wrapper">    
    <div id="container"></div>
    <div id="note">
        <div class="button01"><button id="button01">Zoom in</button></div></td>
        <div id="text">To compare different weapons, SIPRI measures the export value using a common unit called <a href="http://www.sipri.org/databases/armstransfers/background/background_default#TIV-tables" target='_blank'>trend-indicator value (TIV)</a>, expressed in US dollar at constant 1990 prices.</div>
        Source: 
        <a href='http://www.sipri.org/databases/armstransfers' target='_blank'>SIPRI Arm Transfers Database</a>
        <div id="credit">Kuang Keng Kuek Ser / PRI</div>
    </div>
</div>
</div>
</body>

<script> 
$(function () {


  var controller = new ScrollMagic.Controller();
  var scene = new ScrollMagic.Scene({
      triggerElement: '#frame',
      duration: 200
    })
    .setPin('#wrapper')
    .addIndicators()
    .offset(300)
    .addTo(controller)
    .on("progress", function (event) {
      var num = event.progress;
      if(num>0.5){
      var chart = $('#container').highcharts();
      chart.xAxis[0].setExtremes(30, 65); 
      }
    });




    var chart;   
    $(document).ready(function() {

        Highcharts.setOptions({
            lang: {
              thousandsSep: ','
            }
        }),

        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'container',
                type: 'area',
                zoomType: 'x',
            },
            title: {
                text: 'Arms exports to Iran, 1953-2015',
                margin: 20,
            },
            subtitle: {
                enabled: false,
            },
            xAxis: {
                categories: ["1950","1951","1952","1953","1954","1955","1956","1957","1958","1959","1960","1961","1962","1963","1964","1965","1966","1967","1968","1969","1970","1971","1972","1973","1974","1975","1976","1977","1978","1979","1980","1981","1982","1983","1984","1985","1986","1987","1988","1989","1990","1991","1992","1993","1994","1995","1996","1997","1998","1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013","2014","2015"],  
                tickmarkPlacement: 'on', 
                minTickInterval:10,
                plotLines: [{
                  value: 29,
                  color: '#808080',
                  dashStyle: 'shortdash',
                  width: 2,
                  label: {
                      useHTML: true,
                      text: 'Iran<br>revolution',
                      align: 'right',
                      x:18,
                      y:80,
                      style: {
                          fontSize: '11px',
                          color: '#808080',
                          textAlign:'center',
                      }
                  }
                },{
                  value: 3,
                  color: '#808080',
                  dashStyle: 'shortdash',
                  width: 2,
                  label: {
                      useHTML: true,
                      text: 'US-backed<br>coup',
                      align: 'right',
                      x:18,
                      y:80,
                      style: {
                          fontSize: '11px',
                          color: '#808080',
                          textAlign:'center',
                      }
                  }
                }
                ],
                plotBands: [{
                    color: '#f2f2f2',
                    from: 57,
                    to: 65,
                    label:{
                        useHTML: true,
                        text: "UN<br>sanction",
                        style: {
                          fontSize: '11px',
                          color: '#808080',
                          textAlign:'center',
                        }
                    }
                }],
            },
            yAxis: {
                title: {
                  text: 'TIV in $ million (1990 constant USD)',
                  style: {
                    color: '#808080',
                    fontSize: '11px',
                  },  
                },
                endOnTick: false,
            },
            credits: { enabled: false, },
            legend: {
                enabled: true,
            },
            tooltip: {
                headerFormat: 'Year: {point.key}<br>',
                pointFormat: '{series.name}: <b>${point.y:,0f}</b> mil<br>',
                shared: true,
            },
            plotOptions: {
                series:{
                    stickyTracking: false,
                },
                area: {
                  lineWidth: 0,
                  stacking: 'normal',
                  marker: {
                      enabled: false
                }
              }
            },
            series: [ 
                {name: "USA", color:"#377eb8", data:[4,6,0,1,75,110,121,53,119,94,10,107,110,137,141,182,437,179,770,1141,1068,1134,598,1324,2171,4038,3989,4445,2101,214,0,0,0,0,10,4,50,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},
                {name: "Russia", color:"#e41a1c", data:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,114,114,0,13,13,0,0,0,0,0,740,740,0,0,0,0,0,0,0,116,100,90,90,339,772,220,559,83,47,289,119,256,258,341,298,92,85,15,15,368,283,15,15,41,33,15,22,4,4]},
                {name: "China", color:"#FFCE00", data:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,193,219,180,126,516,539,184,60,87,96,103,304,274,58,320,54,70,64,69,80,81,84,80,43,54,47,47,47,62,55,32,9,9,9]},
                {name: "UK", color:"#ff7f00", data:[0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,74,0,49,55,297,718,656,492,691,49,79,250,152,0,4,0,0,125,52,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},
                {name: "Others", color:"#4daf4a", data:[0,0,0,0,0,2,0,0,0,0,1,0,0,0,0,0,5,10,5,41,46,239,49,38,164,414,420,289,653,169,278,482,349,291,163,465,121,194,204,42,28,155,109,125,97,192,5,4,54,0,8,147,262,114,27,0,0,0,0,0,0,15,0,0,0,0]},
            ],
            });
    });
  var chart = $('#container').highcharts();
  var flip = "off";  
  $('#button01').click(function () {
    if(flip=="off"){
      flip="on";  
      $('#button01').text("Zoom out");
      chart.xAxis[0].setExtremes(30, 65); 
    } else {
      flip = "off";
      $('#button01').text("Zoom in");
      chart.xAxis[0].setExtremes(0, 65); 
    } 
  });
    
}); 



 

</script>